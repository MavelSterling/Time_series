tip<-structure(c(43.87, 44.59, 45.24, 45.71, 46.27, 46.89, 47.41, 
                 48.07, 49.19, 49.87, 50.36, 50.83, 51.1, 51.5, 51.68, 52.27, 
                 52.05, 52.01, 52.09, 53.01, 53.99, 54.43, 55.37, 55.97, 55.57, 
                 55.37, 55.37, 55.48, 54.91, 54.67, 54.78, 55.1, 55.32, 55.86, 
                 56.29, 56.78, 56.96, 57.32, 58.09, 59.37, 60.16, 59.78, 60.34, 
                 61.33, 62.29, 62.58, 62.96, 62.86, 62.72, 62.92, 63.1, 62.93, 
                 63.02, 63.42, 63.69, 64.41, 65.03, 65.43, 65.92, 66.95, 67.18, 
                 66.85, 66.97, 67.25, 68, 67.83, 67.24, 67.85, 68.7, 69.95, 69.75, 
                 69.75, 70.1, 69.99, 70.18, 69.83, 70.16, 69.84, 69.74, 70.57, 
                 70.61, 71.43, 73.16, 73.95, 74.53, 75.2, 74.96, 74.69, 74.4, 
                 74.08, 74.37, 74.72, 74.79, 74.98, 74.94, 74.37, 73.88, 74.09, 
                 74.97, 75.91, 75.83, 77.01, 77.92, 79.01, 79.92, 79.69, 80, 81.12, 
                 82.26, 84.91, 84.8, 86.99, 88.36, 87.42, 84.5, 82.22, 85.18, 
                 85.29, 86.81, 85.89, 85.57, 86.14, 85.46, 84.99, 84.12, 85.02, 
                 86.34, 88.13, 88.05, 88.28, 88.94, 89.96, 88.74, 88.06, 87.63, 
                 87, 87.01, 89.02, 91.31, 92.46, 93.94, 95.53, 96.22, 97.67, 96.34, 
                 95.43, 95.74, 96.38, 98.18, 98.83, 99.21, 97.67, 97.81, 97.66, 
                 98.1, 97.68, 95.12, 93.55, 94.89, 96.39, 96.26, 95.5, 94.39, 
                 94.24, 94.77, 95.69, 95.02, 94.77, 95.5, 95.21, 95.48, 95.93, 
                 94.73, 94.53, 94.32, 95.18, 96.57, 98.16, 98.04, 97.86, 97.4, 
                 97.08, 97.82, 98.45, 98.71, 98.06, 100, 98.72, 96.77, 100.44, 
                 99.08, 99.05, 101.07, 102.33, 104.39, 104.38, 103.37, 103.89, 
                 105.48, 105.32, 105.74, 106.19, 105.76, 107.12, 108.1, 108.38, 
                 107.15, 106.9, 107.19, 109.24, 107.76, 108.12, 107.48, 107.31, 
                 106.87, 106.39, 105.86, 107.1, 107.7, 108.17, 109.04, 110.76, 
                 111.29, 111.5, 111.35, 111.14, 111.41, 113.86, 113.72, 113.45, 
                 113.26, 115.97, 117.52, 115.67, 113.86, 114.53, 115.6, 116.37, 
                 118.03, 119.91, 117.99, 118.68, 118.91, 120.35, 120.34, 120.31, 
                 120.79, 119.91), .Tsp = c(1999.41666666667, 2020, 12), class = "ts")
tip

lip<-log(tip)

library(urca)

df.ip<-ur.df(lip, ,lags = 3, type="trend");summary(df.ip)
df.dip<-ur.df(diff(lip), ,lags = 3, type="trend");summary(df.dip)

library(tseries)
df2.ip<-adf.test(lip,k=3);df2.ip
df2.dip<-adf.test(diff(lip),k=3);df2.dip

wienerf<-function(nobs){
  e<-rnorm(nobs)
  #creamos los vectores con los componentes e1 (intercepto), e2 (interc + tendend)
  e1<-e-mean(e)
  e2<-lm(e~seq(1,nobs))$residuals
  #simulaciï¿½n del movimiento browniano
  y1<-cumsum(e1)
  y2<-cumsum(e2)
  intW2.1<-nobs^(-2)*sum(y1^2)
  intW2.2<-nobs^(-2)*sum(y2^2)
  resp<-list(intW2.1=intW2.1,intW2.2=intW2.2)
  resp 
}
nobs<-1000
nsim<-10000
KPSS1<-rep(0,nsim)
KPSS2<-rep(0,nsim)
for(i in 1:nsim){
  BN.mom<-wienerf(nobs)
  KPSS1[i]<-BN.mom$intW2.1
  KPSS2[i]<-BN.mom$intW2.2
}
quantile(KPSS1,probs=c(0.9,0.925,0.957,0.99))
quantile(KPSS2,probs=c(0.9,0.925,0.957,0.99))

### en urca 

kp.ip<-ur.kpss(lip,lags="nil",type="mu") ## use.lag = 3 , "long" = use.lag=10 "nil"=rezagos
summary(kp.ip)

kp.dip<-ur.kpss(diff(lip),lags="short",type="tau") 
summary(kp.dip)

### tseries

kp2.ip<-kpss.test(lip,null="Trend",lshort=TRUE)
kp2.ip

kp2.dip<-kpss.test(diff(lip),null="Trend",lshort=TRUE)
kp2.dip